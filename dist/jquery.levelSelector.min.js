/*! levelSelector - v0.1.1 - 2016-03-24
* https://github.com/seamys/levelSelector
* Copyright (c) 2016 yiim; Licensed MIT */
!function(a,b){"use strict";a.fn.levelSelector=function(b){var c={url:"/levelSelector/list",handel:function(a){return"<option value="+a.Id+">"+a.Name+"</option>"},path:0,sChar:",",change:function(a){return a},create:function(){return a("<select>")},filter:function(a){return a},param:function(a){return{ids:a.join(c.sChar)}},provider:function(b,d){a.ajax(c.url,{type:"GET",dataType:"json",cache:!0,data:c.param(b||[0]),success:d})},defOption:"Choose.."},d=function(){var b=a(this),d={init:function(){a("select",b).remove(),b.on("change","select",d.add),d.reInit()},ajaxCall:function(a,b){return b=c.filter(b),b&&0!==b.length?void a.append(d.opts(b)).show():void a.remove()},add:function(){if(this.value-0!==0){var e=c.create.apply(b);this!==b?(a(this).nextAll("select").remove(),e.insertAfter(this)):e.appendTo(this),e.hide();var f=d.get();c.change.call(b,f),c.provider(f,function(a){d.ajaxCall(e,a)})}else a(this).nextAll("select").remove()},opts:function(a){for(var b=['<option value="0">',c.defOption,"</option>"],d=0;d<a.length;d++)b.push(c.handel(a[d]));return b.join("")},get:function(){var c=[0];return a("select",b).each(function(){this.value&&/\d+/.test(this.value)&&c.push(this.value-0)}),c},reInit:function(){var e=b.attr("val")||c.path;if(e&&"0"!==e){var f=e.split(c.sChar);a.each(f,function(a){if(a>0&&a<f.length){var e=c.create.apply(b).appendTo(b);c.provider(f.slice(0,a),function(b){d.ajaxCall(e,b),e.val(f[a]||0)})}})}else d.add.apply(b)}};d.init()};return c=a.extend({},c,b),this.each(d)}}(jQuery);